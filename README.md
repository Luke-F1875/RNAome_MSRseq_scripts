# Description 
This repository contains the scripts which process and create the bedRmod files for the MSRseq modification data in the RNAome project. This data consists of 9 files, three replicates of three different treatments in our MSRseq pipeline using GM12878 cells as provided by the RNAome project. There are three main scripts in this repository refseq_cleanup.Rmd, RNome_MSRseq_tRNAmod.Rmd, and bedRmod_format_converter.Rmd. 

- refseq_cleanup.Rmd cleans the supplied reference sequence to make a reference sequence which is compatible with the MSRseq pipeline as described here https://doi.org/10.1016/bs.mie.2024.11.009 and as uploaded here https://github.com/Luke-F1875/MSRseq_data_processing_pipeline. 

- RNome_MSRseq_tRNAmod.Rmd cleans and compiles the files generated by the MSRseq pipeline into one compressed csv file.

- bedRmod_format_converter.Rmd takes this compressed civ file and generates the nine bedRmodv2 files uploaded to the RNAome project. This script only generates modifications for the most abundant isodecoders in each isoacceptor group in HEK293T cells as defined in Assari, M., B.J Chew, M.A. Bayat Tork, M. Sobczyk, C-Y. Zhu, H.A.V. Tran, D. Rudzka, W. Zhang, T. Pan: Decoding human tRNA modifications and crosstalk by enhanced single-read analysis, Genome Biol. in press (2026). 

Further descriptions of each script are in the README descriptors in the scripts.

All three of these scripts are written in R version 4.2.2 (2022-10-31). 

**Other repository materials:**
Along with the three main scripts built by us there are other materials in this repository.

- Step1_260_seq_hg38-mature-tRNAs.fa is the reference file provided by the RNAome project for tRNA. 

- Step1_260_seq_hg38-mature-tRNAs_renamed.fa is the cleaned reference file made by refseq_cleanup.Rmd that is compatible with the MSRseq pipeline. 

- Table S3_sequence and modification sites for Fig3a.xlsx is the xlsx table with all of the modifications for the  most abundant isodecoders in each isoacceptor in HEK293T cells as defined in Assari, M., B.J Chew, M.A. Bayat Tork, M. Sobczyk, C-Y. Zhu, H.A.V. Tran, D. Rudzka, W. Zhang, T. Pan: Decoding human tRNA modifications and crosstalk by enhanced single-read analysis, Genome Biol. in press (2026).

- scripts p-value calculation/bedrmod_score_stoichiometry.R is a script made by Iourii Motorine from the  Université de Lorraine and modified here for use in these scripts. It calculates the modification scores using stoichiometry. 

-  hg38_chromosomal_tRNA_genes_high_confidence_intro_remove+CCA_upper_case2.fa is another reference sequence which is chromosomal information about the tRNA genes. This is used in the bedRmod_format_converter.Rmd script.

- data_cleaned_5_HRPC.csv.zip is the file generated by RNome_MSRseq_tRNAmod.Rmd. Here for convenience.

**Pipeline overview:**
To run this pipeline there are 4 main steps. 

1. Use the refseq_cleanup.Rmd to clean the provided reference sequence into a format that is usable in our MSRseq technique

2. Follow the MSRseq pipeline on the illumina data as described here and  https://doi.org/10.1016/bs.mie.2024.11.009 and as uploaded here https://github.com/Luke-F1875/MSRseq_data_processing_pipeline. The data submitted for this RNAome project is already demultiplexed so the demultiplexing step described here can be skipped. 

3. Use the RNome_MSRseq_tRNAmod.Rmd on the generated .tsv folder to create the data_cleaned_5_HRPC.csv.zip file.

4. Use the bedRmod_format_converter.Rmd to convert the data_cleaned_5_HRPC.csv.zip file into the nine bedRmodv2 files.
